<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ElektroSys - Calculadora de Motores</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    colors: {
                        brand: {
                            dark: '#0f172a',
                            blue: '#1e40af',
                            orange: '#f59e0b',
                            text: '#1e293b'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        input[type=range] { -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 16px; width: 16px; border-radius: 50%;
            background: #3b82f6; margin-top: -6px; cursor: pointer;
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 4px; cursor: pointer; background: #e2e8f0; border-radius: 2px;
        }
    </style>
</head>
<body class="bg-brand-dark text-slate-300 font-sans antialiased">

    <nav class="border-b border-slate-700 bg-slate-900/50 backdrop-blur-md sticky top-0 z-50">
        <div class="container mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <i class="fa-solid fa-bolt text-yellow-400 text-xl"></i>
                <span class="text-white font-bold text-lg tracking-wide">ElektroSys</span>
            </div>
            <div class="hidden md:flex gap-8 text-sm font-medium text-slate-400">
                <a href="#" class="text-white">Calculadora</a>
                <a href="#" class="hover:text-white transition">Sobre</a>
            </div>
        </div>
    </nav>

    <header class="text-center py-10 px-4">
        <h1 class="text-3xl md:text-4xl font-bold text-white mb-3">
            Dimensionamento de <span class="text-blue-400">Motores Trifásicos</span>
        </h1>
        <p class="text-slate-400 max-w-2xl mx-auto">
            Cálculos automáticos conforme NBR 5410. Altere os valores abaixo para ver o resultado em tempo real.
        </p>
    </header>

    <main class="container mx-auto px-4 pb-20">
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <div class="lg:col-span-4 space-y-4">
                <div class="bg-white rounded-xl shadow-lg p-6 text-brand-text relative">
                    <div class="flex items-center gap-2 mb-6 border-b border-gray-100 pb-2">
                        <i class="fa-solid fa-gear text-blue-600"></i>
                        <h2 class="font-bold text-lg">Parâmetros</h2>
                    </div>

                    <div class="space-y-5">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Potência Mecânica</label>
                            <div class="flex">
                                <input type="number" id="inputPower" value="10" class="w-full border border-gray-300 rounded-l-lg px-3 py-2 focus:outline-none focus:border-blue-500 font-semibold text-gray-700">
                                <select id="inputUnit" class="bg-gray-100 border border-l-0 border-gray-300 rounded-r-lg px-3 py-2 text-sm font-semibold text-gray-600">
                                    <option value="cv">CV</option>
                                    <option value="hp">HP</option>
                                    <option value="kw">kW</option>
                                </select>
                            </div>
                            <div class="text-right text-xs text-gray-400 mt-1">= <span id="displayWatts">7355</span> W</div>
                        </div>

                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Tensão (Trifásico)</label>
                            <div class="grid grid-cols-3 gap-2" id="voltageSelector">
                                <button data-volts="220" class="volt-btn border border-gray-200 rounded py-1.5 text-sm font-medium text-gray-500 hover:bg-gray-50">220V</button>
                                <button data-volts="380" class="volt-btn bg-blue-600 text-white rounded py-1.5 text-sm font-medium shadow-md ring-2 ring-blue-200">380V</button>
                                <button data-volts="440" class="volt-btn border border-gray-200 rounded py-1.5 text-sm font-medium text-gray-500 hover:bg-gray-50">440V</button>
                            </div>
                        </div>

                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-xs font-bold text-gray-500">Fator de Potência</label>
                                <span id="displayCos" class="text-xs font-bold text-blue-600">0.85</span>
                            </div>
                            <input type="range" id="inputCos" min="0.5" max="1" step="0.01" value="0.85">
                        </div>

                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-xs font-bold text-gray-500">Rendimento (η)</label>
                                <span id="displayEff" class="text-xs font-bold text-green-600">0.90</span>
                            </div>
                            <input type="range" id="inputEff" min="0.5" max="1" step="0.01" value="0.90">
                        </div>

                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-xs font-bold text-gray-500">Distância do Quadro</label>
                                <span class="text-xs font-bold text-gray-700"><span id="displayDist">20</span> m</span>
                            </div>
                            <input type="range" id="inputDist" min="1" max="200" value="20">
                        </div>
                    </div>
                </div>

                <div class="bg-slate-800 rounded-lg p-4 border border-slate-700 shadow-inner text-center">
                    <p class="text-[10px] text-slate-400 uppercase tracking-widest mb-1">Cálculo Realizado</p>
                    <div class="text-white text-sm font-serif italic opacity-80">
                         In = P / (√3 · V · cosφ · η)
                    </div>
                </div>
            </div>

            <div class="lg:col-span-8 space-y-6">
                
                <div class="bg-white rounded-xl shadow-lg p-0 overflow-hidden flex flex-col md:flex-row relative">
                    <div class="p-8 flex-1 flex flex-col justify-center z-10">
                        <p class="text-xs font-bold text-gray-400 uppercase tracking-wide mb-1">Corrente Nominal (In)</p>
                        <h2 class="text-6xl font-extrabold text-slate-800 mb-2"><span id="resultIn">14.6</span><span class="text-2xl text-gray-500 ml-1">A</span></h2>
                        <div class="inline-flex items-center gap-2 bg-gray-100 rounded-full px-3 py-1 w-max">
                            <span class="text-sm font-semibold text-slate-600">Partida (Ip): <span id="resultIp" class="text-blue-600">~110 A</span></span>
                        </div>
                    </div>
                    <div class="flex-1 bg-gradient-to-br from-gray-50 to-gray-200 min-h-[180px] flex items-center justify-center relative">
                        <i class="fa-solid fa-industry text-8xl text-gray-300 opacity-50 absolute right-4 bottom-4"></i>
                        <div class="absolute bottom-4 left-4 right-4 bg-white/90 backdrop-blur-sm rounded-lg p-3 shadow-sm border border-white/50 text-xs text-gray-600 flex justify-between">
                            <div><span class="block font-bold">Potência Ativa</span><span id="resPactive">7355 W</span></div>
                            <div class="text-right"><span class="block font-bold">Potência Aparente</span><span id="resPaparent">9614 VA</span></div>
                        </div>
                    </div>
                </div>

                <h3 class="flex items-center gap-2 text-lg font-semibold text-white mt-8">
                    <i class="fa-solid fa-table-cells-large text-blue-400"></i> Sugestão de Componentes
                </h3>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div class="bg-white rounded-xl p-5 shadow-md border-l-4 border-red-500">
                        <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider block mb-2">Proteção</span>
                        <h4 class="font-bold text-slate-800">Disjuntor Motor</h4>
                        <div class="text-3xl font-bold text-red-600 mt-2"><span id="resBreaker">20</span> A</div>
                        <p class="text-[10px] text-gray-400 mt-1">Curva C Recomendada</p>
                    </div>

                    <div class="bg-white rounded-xl p-5 shadow-md border-l-4 border-yellow-400">
                        <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider block mb-2">Alimentação</span>
                        <h4 class="font-bold text-slate-800">Cabo PVC</h4>
                        <div class="text-3xl font-bold text-slate-800 mt-2"><span id="resCable">2.5</span> <span class="text-lg">mm²</span></div>
                        <p class="text-[10px] text-green-600 mt-1">Queda de Tensão: <span id="resDrop">0.92</span>%</p>
                    </div>

                    <div class="bg-white rounded-xl p-5 shadow-md border-l-4 border-blue-500">
                        <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider block mb-2">Comando</span>
                        <h4 class="font-bold text-slate-800">Contator (AC-3)</h4>
                        <div class="text-3xl font-bold text-slate-800 mt-2">Ie ≥ <span id="resContactor">15</span> A</div>
                        <p class="text-[10px] text-blue-500 mt-1">Relé: <span id="resRelay">11-17</span> A</p>
                    </div>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r shadow-sm flex gap-3 text-xs text-yellow-800">
                    <i class="fa-solid fa-triangle-exclamation text-yellow-600 mt-1"></i>
                    <p><strong>Isenção de responsabilidade:</strong> Esta ferramenta é para fins educacionais e pré-dimensionamento. Instalações elétricas reais exigem validação de um Engenheiro Eletricista habilitado conforme NBR 5410.</p>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Variáveis Globais
        let currentVoltage = 380;
        
        // Elementos do DOM (Entradas)
        const elPower = document.getElementById('inputPower');
        const elUnit = document.getElementById('inputUnit');
        const elCos = document.getElementById('inputCos');
        const elEff = document.getElementById('inputEff');
        const elDist = document.getElementById('inputDist');
        const btnVolts = document.querySelectorAll('.volt-btn');

        // Elementos do DOM (Displays numéricos dos sliders)
        const dispWatts = document.getElementById('displayWatts');
        const dispCos = document.getElementById('displayCos');
        const dispEff = document.getElementById('displayEff');
        const dispDist = document.getElementById('displayDist');

        // Elementos do DOM (Saídas)
        const outIn = document.getElementById('resultIn');
        const outIp = document.getElementById('resultIp');
        const outPactive = document.getElementById('resPactive');
        const outPaparent = document.getElementById('resPaparent');
        const outBreaker = document.getElementById('resBreaker');
        const outCable = document.getElementById('resCable');
        const outDrop = document.getElementById('resDrop');
        const outContactor = document.getElementById('resContactor');
        const outRelay = document.getElementById('resRelay');

        // Tabelas simplificadas (Baseado em NBR aproximada para PVC 70C em Eletroduto B1)
        const standardBreakers = [2, 4, 6, 10, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125];
        const cableTable = [
            { sec: 1.5, amp: 15.5 },
            { sec: 2.5, amp: 21 },
            { sec: 4.0, amp: 28 },
            { sec: 6.0, amp: 36 },
            { sec: 10.0, amp: 50 },
            { sec: 16.0, amp: 68 },
            { sec: 25.0, amp: 89 },
            { sec: 35.0, amp: 111 },
            { sec: 50.0, amp: 134 },
            { sec: 70.0, amp: 171 },
            { sec: 95.0, amp: 207 }
        ];

        // Função Principal de Cálculo
        function calculate() {
            // 1. Pegar valores
            let powerVal = parseFloat(elPower.value) || 0;
            let unit = elUnit.value;
            let cosPhi = parseFloat(elCos.value);
            let eff = parseFloat(elEff.value);
            let dist = parseFloat(elDist.value);

            // Atualizar displays de texto dos sliders
            dispCos.innerText = cosPhi;
            dispEff.innerText = eff;
            dispDist.innerText = dist;

            // 2. Converter Potência para Watts
            let watts = 0;
            if (unit === 'cv') watts = powerVal * 735.5;
            else if (unit === 'hp') watts = powerVal * 745.7;
            else watts = powerVal * 1000;
            
            dispWatts.innerText = Math.round(watts);
            outPactive.innerText = Math.round(watts) + " W";

            // 3. Calcular Corrente Nominal (In)
            // Fórmula: In = P(w) / (sqrt(3) * V * cos * eff)
            let root3 = Math.sqrt(3); // 1.732
            let In = watts / (root3 * currentVoltage * cosPhi * eff);
            
            // Segurança contra divisão por zero
            if(!isFinite(In)) In = 0;

            outIn.innerText = In.toFixed(1);

            // 4. Calcular Corrente de Partida (Ip) - Estimativa 7.5x
            let Ip = In * 7.5;
            outIp.innerText = "~" + Math.round(Ip) + " A";

            // 5. Potência Aparente (S)
            let S = (root3 * currentVoltage * In);
            outPaparent.innerText = Math.round(S) + " VA";

            // 6. Selecionar Disjuntor (In * 1.25 para folga de segurança simplificada)
            let targetBreaker = In * 1.25;
            let selectedBreaker = standardBreakers.find(b => b > targetBreaker) || "Consulta";
            outBreaker.innerText = selectedBreaker;

            // 7. Selecionar Cabo (Pelo critério de capacidade de corrente > Disjuntor)
            // O cabo deve suportar o disjuntor, não apenas o motor.
            let breakerVal = (typeof selectedBreaker === 'number') ? selectedBreaker : In * 1.25;
            let selectedCable = cableTable.find(c => c.amp >= breakerVal);
            let cableSection = selectedCable ? selectedCable.sec : "Espec.";
            outCable.innerText = cableSection;

            // 8. Calcular Queda de Tensão
            // dU% = (sqrt(3) * rho * L * I) / (S * V) * 100
            // rho cobre = 0.0172 ohm.mm²/m
            let cableS = (typeof cableSection === 'number') ? cableSection : 1000; // Valor alto se indefinido
            let voltageDropVal = (root3 * 0.0172 * dist * In) / (cableS * currentVoltage) * 100;
            
            // Se a queda for muito alta (> 4%), sugerir cabo maior (lógica visual simples: fica vermelho)
            let dropElem = document.getElementById('resDrop').parentNode;
            if(voltageDropVal > 4) {
                dropElem.className = "text-[10px] text-red-600 mt-1 font-bold";
                outDrop.innerText = voltageDropVal.toFixed(2) + "% (ALTA)";
            } else {
                dropElem.className = "text-[10px] text-green-600 mt-1";
                outDrop.innerText = voltageDropVal.toFixed(2);
            }

            // 9. Contator e Relé
            outContactor.innerText = Math.ceil(In); // Contator >= In
            
            // Faixa de ajuste do relé (geralmente In fica no meio)
            let relayMin = (In * 0.8).toFixed(1);
            let relayMax = (In * 1.2).toFixed(1);
            outRelay.innerText = `${relayMin} - ${relayMax}`;
        }

        // Event Listeners (Ouvir mudanças)
        elPower.addEventListener('input', calculate);
        elUnit.addEventListener('change', calculate);
        elCos.addEventListener('input', calculate);
        elEff.addEventListener('input', calculate);
        elDist.addEventListener('input', calculate);

        // Lógica dos Botões de Tensão
        btnVolts.forEach(btn => {
            btn.addEventListener('click', (e) => {
                // Remove estilo ativo de todos
                btnVolts.forEach(b => {
                    b.className = "volt-btn border border-gray-200 rounded py-1.5 text-sm font-medium text-gray-500 hover:bg-gray-50";
                });
                // Adiciona estilo ativo no clicado
                e.target.className = "volt-btn bg-blue-600 text-white rounded py-1.5 text-sm font-medium shadow-md ring-2 ring-blue-200";
                
                // Atualiza valor
                currentVoltage = parseInt(e.target.dataset.volts);
                calculate();
            });
        });

        // Calcular ao carregar a página
        calculate();

    </script>
</body>
</html>